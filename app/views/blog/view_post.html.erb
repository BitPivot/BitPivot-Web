<article class='post'>

  <section class='post-area'>

    <div class='post-header'>
      <% if post.banner_image %>
        <%= image_tag post.banner_image, class: 'blog-banner' %>
      <% end %>

      <hgroup>
        <h1><%= link_to post.title, "/blog/posts/#{post.file_name.slice(0..(post.file_name.index('.')-1))}" %></h1>

        <h2><%= link_to post.subtitle, "/blog/posts/#{post.file_name.slice(0..(post.file_name.index('.')-1))}" %></h2>
      </hgroup>
    </div>

    <div class='post-metadata'>
      By <%= link_to post.author, "/blog/authors/#{post.author.split(' ')[0]}".downcase %>
      on <span class='date'><%= "#{Date::MONTHNAMES[post.month]} #{post.day}, #{post.year}" %></span>
    </div>

    <div class='post-body'>
      <%= render inline: post.body %>
    </div>

  </section>


  <section class='comments'>
    <h1>Discussion</h1>

    <% if post.blog_post_comments.length == 0 %>
      <span class='no-comments'>There are currently no comments.</span>
    <% end %>

    <% post.blog_post_comments.where(:respond_to_id => nil).each do |comment| %>
      <% if comment.approved %>
        <%= render template: 'blog/comment', locals: {
            depth: 1,
            post: post,
            comment: comment,
            respond_to_id: defined?(respond_to_id) ? respond_to_id : nil
        } %>
      <% end %>
    <% end %>
  </section>


  <section class='create-comment'>
    <h1>Contribute to this Article</h1>
    <%= render template: 'blog/create_comment', locals: {post: post, respond_to_id: nil} %>
  </section>

</article>
